
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Êú®Êõ¥Â§ß‰π±ÊñóÔºöËµõÂçöÊ∏ÖÁêÜÂëò</title>
    <!-- ÂºïÂÖ• Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- ÂºïÂÖ• React Âíå Babel -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700;900&display=swap');

      body {
        font-family: 'Noto Sans SC', sans-serif;
        background-color: #000;
        color: #e2e8f0;
        overflow: hidden;
        touch-action: none;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
      }

      .glitch-text { position: relative; }
      .glitch-text::before, .glitch-text::after {
        content: attr(data-text);
        position: absolute;
        top: 0; left: 0; width: 100%; height: 100%;
      }
      .glitch-text::before {
        left: 2px; text-shadow: -1px 0 #ff00c1;
        clip: rect(44px, 450px, 56px, 0);
        animation: glitch-anim 5s infinite linear alternate-reverse;
      }
      .glitch-text::after {
        left: -2px; text-shadow: -1px 0 #00fff9;
        clip: rect(44px, 450px, 56px, 0);
        animation: glitch-anim2 5s infinite linear alternate-reverse;
      }
      @keyframes glitch-anim {
        0% { clip: rect(30px, 9999px, 10px, 0); }
        20% { clip: rect(80px, 9999px, 90px, 0); }
        40% { clip: rect(10px, 9999px, 50px, 0); }
        60% { clip: rect(40px, 9999px, 20px, 0); }
        80% { clip: rect(70px, 9999px, 60px, 0); }
        100% { clip: rect(20px, 9999px, 80px, 0); }
      }
      @keyframes glitch-anim2 {
        0% { clip: rect(10px, 9999px, 80px, 0); }
        20% { clip: rect(40px, 9999px, 10px, 0); }
        40% { clip: rect(80px, 9999px, 50px, 0); }
        60% { clip: rect(20px, 9999px, 90px, 0); }
        80% { clip: rect(50px, 9999px, 20px, 0); }
        100% { clip: rect(30px, 9999px, 60px, 0); }
      }
      
      .scrollbar-hide::-webkit-scrollbar { display: none; }
      .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }

      /* Animations */
      @keyframes bounce-in {
          0% { transform: scale(0.3); opacity: 0; }
          50% { transform: scale(1.05); opacity: 1; }
          70% { transform: scale(0.9); }
          100% { transform: scale(1); }
      }
      .animate-bounce-in { animation: bounce-in 0.5s cubic-bezier(0.215, 0.610, 0.355, 1.000) both; }
      
      @keyframes pop-in {
          0% { transform: scale(0); opacity: 0; }
          80% { transform: scale(1.1); opacity: 1; }
          100% { transform: scale(1); }
      }
      .animate-pop-in { animation: pop-in 0.3s ease-out forwards; }
    </style>
</head>
<body>
    <div id="root"></div>

    <!-- Ê†∏ÂøÉÊ∏∏ÊàèÈÄªËæëËÑöÊú¨ (BabelÁºñËØë) -->
    <script type="text/babel" data-presets="react,typescript">
        const { useState, useEffect, useRef, useCallback } = React;

        // --- 1. TYPES ---
        enum GamePhase {
            WELCOME = 'WELCOME',
            STORY = 'STORY', 
            PLAYING = 'PLAYING',
            SHOP = 'SHOP',
            BOSS_INTRO = 'BOSS_INTRO',
            GAME_OVER = 'GAME_OVER',
            VICTORY = 'VICTORY',
        }

        // --- 2. DATA (Meme Content) ---
        const DEATH_MESSAGES = {
            'keyboard_man': "‰Ω†Ë¢´ÈîÆÁõò‰æ†Âñ∑Âà∞ÊÄÄÁñë‰∫∫ÁîüÔºåÁõ¥Êé•ÈÄÄÁΩë‰∫Ü„ÄÇ",
            'tian_gou': "‰Ω†Ë¢´ËàîÁãóÁöÑÁúüÂøÉÊÑüÂä®ÔºàÊÅ∂ÂøÉÔºâÊ≠ª‰∫Ü„ÄÇ",
            'lemon_head': "‰Ω†Ë¢´ÈÖ∏Ê≠ª‰∫Ü„ÄÇËøôÂ∞±Á†¥Èò≤‰∫ÜÔºü",
            'gai_liu_zi': "‰Ω†Âú®Ë°óÂ§¥Ë¢´È¨ºÁÅ´Â∞ëÂπ¥ÊíûÈ£ûÔºåÁ§æ‰øùÈÉΩÊ≤°ÂæóËµî„ÄÇ",
            'chi_gua': "‰Ω†Âú®Âõ¥ËßÇÁæ§‰ºóÁöÑÁìúÂ≠êÂ£≥Êµ∑Ê¥ã‰∏≠Á™íÊÅØ‰∫Ü„ÄÇ",
            'da_ye': "Â§ßÁà∑‰ΩøÁî®‰∫Ü'ÈÄÄÈÄÄÈÄÄ'Ôºå‰Ω†Ë¢´Áâ©ÁêÜË∂ÖÂ∫¶‰∫Ü„ÄÇ",
            'marketing_account': "‰Ω†Ë¢´Ëê•ÈîÄÂè∑ÁöÑË∞£Ë®ÄÊ¥óËÑëÔºåÂèòÊàê‰∫ÜÂÇªÂ≠ê„ÄÇ",
            'clown': "Â∞è‰∏ëÁ´üÊòØ‰Ω†Ëá™Â∑±„ÄÇ",
            'minion': "‰Ω†Ë¢´ÂΩìÊàêÂûÉÂúæÊ∏ÖÁêÜÊéâ‰∫Ü„ÄÇ",
            'tao_wa_big': "‰Ω†Ë¢´Êó†ÈôêÂ•óÂ®ÉÂõ∞Âú®Âæ™ÁéØÈáåÂá∫‰∏çÊù•‰∫Ü„ÄÇ",
            'tao_wa_med': "‰Ω†ÂÄíÂú®‰∫ÜÂ•óÂ®ÉÁöÑÁ¨¨‰∫åÂ±Ç„ÄÇ",
            'tao_wa_small': "‰Ω†Á´üÁÑ∂Ë¢´ÊúÄÂ∞èÁöÑÂ•óÂ®ÉÂπ≤Êéâ‰∫ÜÔºü",
            'river_crab': "‰Ω†ÁöÑÂÜÖÂÆπËøùËßÑÔºåÂ∑≤Ë¢´Ê≤≥ËüπÂ±èËîΩ„ÄÇ",
            'boss_kpi': "‰Ω†Ë¢´ÂÖ¨Âè∏'ÁªìÊûÑÊÄß‰ºòÂåñ'‰∫Ü„ÄÇËØ∑Á´ãÂàªÂäûÁêÜÁ¶ªËÅåÊâãÁª≠„ÄÇ",
            'unknown': "‰Ω†ÁåùÊ≠ª‰∫Ü„ÄÇËøôÂ∞±ÊòØ996ÁöÑÁ¶èÊä•„ÄÇ"
        };

        const ENEMIES = {
            'keyboard_man': {
                type: 'keyboard_man', emoji: '‚å®Ô∏è', hp: 30, speed: 2, damage: 10, score: 15,
                description: "ÈáéÁîüÈîÆÁõò‰æ†ÔºåÊìÖÈïøËøúÁ®ãËæìÂá∫ËßÇÁÇπÔºåÂè™Ë¶ÅËøòÂú®ÊâìÂ≠óÂ∞±ÊòØÊó†ÊïåÁöÑ„ÄÇ",
                behavior: 'shooter', projectileChar: 'ÊÄ•', projectileOptions: ["ÊÄ•", "ÂÖ∏", "Â≠ù", "‰πê", "Â¥©", "Ëµ¢", "È∫ª"],
                attackPattern: 'single', sizeScale: 1.0, projectileSize: 20, projectileColor: '#f87171',
                deathQuotes: ["ÊÄ•‰∫ÜÊÄ•‰∫Ü", "ÊàëÈîÆÁõòÂùè‰∫Ü", "‰∏çËá≥‰∫éÂêß", "ÂÖ∏", "Êàë‰∏çÊúç"]
            },
            'tian_gou': {
                type: 'tian_gou', emoji: 'üê∂', hp: 25, speed: 4.5, damage: 8, score: 8,
                description: "Âø†ËØöÁöÑËàîÁãóÔºåÁúãÂà∞Â•≥Á•ûÂ∞±‰ºö‰∏çÈ°æ‰∏ÄÂàáÂÜ≤‰∏äÊù•ÔºåÈÄüÂ∫¶ÊûÅÂø´„ÄÇ",
                behavior: 'chase', sizeScale: 0.8, deathQuotes: ["Â•≥Á•û...", "Âú®Âêó", "Êó©ÂÆâ", "ÊàëÈîô‰∫Ü", "Ê±™"]
            },
            'lemon_head': {
                type: 'lemon_head', emoji: 'üçã', hp: 50, speed: 1.5, damage: 10, score: 12,
                description: "Êü†Ê™¨Á≤æÔºåÊ≠ª‰∫°ÂêéÁïô‰∏ãÈÖ∏Ê∂≤Ê±†ÔºåË∏©‰∏äÂéª‰ºöÂ§ßÂπÖÂáèÈÄü„ÄÇ",
                behavior: 'chase', sizeScale: 0.9, deathQuotes: ["ÈÖ∏‰∫Ü", "ÊÅ∞Êü†Ê™¨", "‰Ω†‰ªÄ‰πàÂÆ∂Â∫≠", "ÁúüÈÖ∏", "ÂëµÂëµ"]
            },
            'gai_liu_zi': {
                type: 'gai_liu_zi', emoji: 'üï∫', hp: 45, speed: 5, damage: 12, score: 20,
                description: "ËØ•Ê∫úÂ≠êÔºåÊ≤°‰∫ãÂà∞Â§ÑÊôÉÊÇ†ÔºåÂÅ∂Â∞î‰ºöÂèëËµ∑ÊûÅÈÄüÈ¨ºÁÅ´ÂÜ≤ÊíûÔºåÊ≥®ÊÑèË∫≤ÈÅøÔºÅ",
                behavior: 'circle', sizeScale: 1.1, deathQuotes: ["ÊëáËµ∑Êù•", "Âà´ÊâíÊãâÊàë", "Áªô‰Ω†ËÑ∏‰∫Ü", "Ëä±Êâã"]
            },
            'chi_gua': {
                type: 'chi_gua', emoji: 'üçâ', hp: 80, speed: 0.5, damage: 15, score: 25,
                description: "ÂêÉÁìúÁæ§‰ºóÔºåÂâçÊéíÂõ¥ËßÇÔºåËôΩÁÑ∂‰∏çÂä®‰ΩÜ‰ºöÂêêÁìúÂ≠êÔºàÂ≠êÂºπÔºâ„ÄÇ",
                behavior: 'turret', projectileChar: 'Áìú', projectileSize: 22, attackPattern: 'single',
                projectileColor: '#22c55e', sizeScale: 1.2, deathQuotes: ["‰øùÁÜüÂêó", "ÂêÉÁìú", "ÂâçÊéí", "ËøôÂ∞±ÂÆå‰∫ÜÔºü"]
            },
            'da_ye': {
                type: 'da_ye', emoji: 'üë¥', hp: 200, speed: 1.2, damage: 30, score: 40,
                description: "Â∞èÂå∫Â§ßÁà∑Ôºå‰ºöÂèëÂ∞ÑÂª∂ËøüÁàÜÁÇ∏ÁöÑ‚ÄúÈÄÄÈÄÄÈÄÄ‚ÄùÊ≥ïÊúØÔºåË°ÄÈáèÊûÅÂéö„ÄÇ",
                behavior: 'tank', projectileChar: 'ÈÄÄ', projectileSize: 40, attackPattern: 'explode',
                projectileColor: '#fbbf24', sizeScale: 1.8, deathQuotes: ["Âπ¥ËΩª‰∫∫", "‰∏çËÆ≤Ê≠¶Âæ∑", "ËÄóÂ≠êÂ∞æÊ±Å", "Â§ßÊÑè‰∫Ü"]
            },
            'marketing_account': {
                type: 'marketing_account', emoji: 'üì¢', hp: 90, speed: 1, damage: 15, score: 30,
                description: "Ëê•ÈîÄÂè∑Ôºå‰∏ÄÂº†Âò¥Â∞±ÊòØÊï£ÂºπË∞£Ë®ÄÔºå‰ª§‰∫∫Èò≤‰∏çËÉúÈò≤„ÄÇ",
                behavior: 'shooter', projectileChar: 'Ë∞£', attackPattern: 'spread', sizeScale: 1.5,
                projectileSize: 24, projectileColor: '#a855f7', deathQuotes: ["ÈúáÊÉäÔºÅ", "ÁúãÂì≠‰∫Ü", "Âà†ÂâçÈÄüÁúã", "ÂÆ∂‰∫∫‰ª¨Ë∞ÅÊáÇ", "Á∫ØË∑Ø‰∫∫"]
            },
            'clown': {
                type: 'clown', emoji: 'ü§°', hp: 70, speed: 3.5, damage: 18, score: 25,
                description: "Â∞è‰∏ëÔºå‰∏ç‰ªÖÊòØÂøÉÁêÜ‰∏äÁöÑÔºåÁâ©ÁêÜ‰∏ä‰πü‰ºöÂÉèÁñØÂ≠ê‰∏ÄÊ†∑ÂÜ≤ËøáÊù•„ÄÇ",
                behavior: 'rusher', sizeScale: 1.2, deathQuotes: ["Â∞è‰∏ëÁ´üÊòØÊàë", "Áé©‰∏çËµ∑Ôºü", "ÂéüÊù•ÊàëÊòØÂ∞è‰∏ë", "Âà´ÊÄ•", "ËøôÂ∞±Á†¥Èò≤‰∫Ü"]
            },
            'minion': {
                type: 'minion', emoji: 'üî®', hp: 40, speed: 2.5, damage: 5, score: 5,
                description: "Â∑•ÂÖ∑‰∫∫ÔºåÊØ´Êó†ÊÑüÊÉÖÁöÑÊâìÂ∑•Êú∫Âô®Ôºå‰ºöÈöèÊú∫Ê∏∏Ëµ∞„ÄÇ",
                behavior: 'minion', sizeScale: 0.6, deathQuotes: ["ÊàëÊòØËá™ÊÑøÁöÑ", "996Á¶èÊä•", "ÊàëÁà±Âä†Áè≠", "Êî∂Âà∞"]
            },
            'tao_wa_big': {
                type: 'tao_wa_big', emoji: 'üì¶', hp: 120, speed: 1.5, damage: 15, score: 30,
                description: "Á¶ÅÊ≠¢Â•óÂ®ÉÔºàÂ§ßÔºâÔºåÊâìÊ≠ªÂêé‰ºöÂàÜË£ÇÂá∫‰∏§‰∏™‰∏≠ÂûãÂ•óÂ®É„ÄÇ",
                behavior: 'chase', sizeScale: 1.5, deathQuotes: ["ËøòÊ≤°ÂÆåÂë¢", "ÂÜçÊù•", "Â•óÂ®ÉÂºÄÂßã"]
            },
            'tao_wa_med': {
                type: 'tao_wa_med', emoji: 'ü•°', hp: 60, speed: 2, damage: 10, score: 15,
                description: "Á¶ÅÊ≠¢Â•óÂ®ÉÔºà‰∏≠ÔºâÔºåÊâìÊ≠ªÂêé‰ºöÂàÜË£ÇÂá∫‰∏§‰∏™Â∞èÂûãÂ•óÂ®É„ÄÇ",
                behavior: 'chase', sizeScale: 1.0, deathQuotes: ["ËøòÊúâ", "ÁªßÁª≠"]
            },
            'tao_wa_small': {
                type: 'tao_wa_small', emoji: 'üç¨', hp: 30, speed: 3, damage: 5, score: 5,
                description: "Á¶ÅÊ≠¢Â•óÂ®ÉÔºàÂ∞èÔºâÔºåÁªà‰∫éÂà∞Â§¥‰∫Ü„ÄÇ",
                behavior: 'chase', sizeScale: 0.7, deathQuotes: ["ÁªìÊùü‰∫Ü", "Ê≤°‰∫Ü"]
            },
            'river_crab': {
                type: 'river_crab', emoji: 'ü¶Ä', hp: 150, speed: 3, damage: 20, score: 35,
                description: "Ê≤≥ËüπÔºåÊ®™Ë°åÈú∏ÈÅìÔºåËôΩÁÑ∂‰∏çÊÄé‰πàÊâì‰∫∫‰ΩÜÊòØÊå°Ë∑Ø‰∏îÂæàÁ°¨„ÄÇ",
                behavior: 'rusher', sizeScale: 1.4, deathQuotes: ["Ë¢´Â§π‰∫Ü", "ÂíåË∞ê", "404"]
            },
            'boss_kpi': {
                type: 'boss_kpi', emoji: 'üëπ', hp: 5000, speed: 2.5, damage: 25, score: 10000,
                description: "KPIÂ§ßÈ≠îÁéãÔºåÊéåÊè°ÁùÄ‰Ω†ÁöÑÁîüÊùÄÂ§ßÊùÉÔºå‰∫åÈò∂ÊÆµ‰ºöÊõ¥Âä†ÁñØÁãÇ„ÄÇ",
                behavior: 'boss', projectileChar: 'Ë£Å', attackPattern: 'spiral', sizeScale: 4.5,
                projectileSize: 35, projectileColor: '#ef4444', deathQuotes: ["ÂÖ¨Âè∏ÈúÄË¶ÅÈôçÊú¨Â¢ûÊïà...", "Ëøô‰∏çÁ¨¶ÂêàÂ∫ïÂ±ÇÈÄªËæë...", "ÊàëÁöÑÊúüÊùÉ..."]
            }
        };

        const WAVES = [
            { waveNumber: 1, duration: 60, enemies: [{ type: 'tian_gou', weight: 8 }, { type: 'keyboard_man', weight: 2 }], spawnRate: 60 },
            { waveNumber: 2, duration: 60, enemies: [{ type: 'tian_gou', weight: 4 }, { type: 'keyboard_man', weight: 4 }, { type: 'lemon_head', weight: 2 }], spawnRate: 55 },
            { waveNumber: 3, duration: 60, enemies: [{ type: 'tao_wa_big', weight: 3 }, { type: 'gai_liu_zi', weight: 3 }, { type: 'chi_gua', weight: 3 }], spawnRate: 50 },
            { waveNumber: 4, duration: 60, enemies: [{ type: 'clown', weight: 3 }, { type: 'marketing_account', weight: 4 }, { type: 'river_crab', weight: 2 }, { type: 'gai_liu_zi', weight: 2 }], spawnRate: 45 },
            { waveNumber: 5, duration: 60, enemies: [{ type: 'da_ye', weight: 3 }, { type: 'chi_gua', weight: 3 }, { type: 'tao_wa_big', weight: 3 }], spawnRate: 40 },
            { waveNumber: 6, duration: 60, enemies: [{ type: 'marketing_account', weight: 4 }, { type: 'river_crab', weight: 3 }, { type: 'lemon_head', weight: 4 }], spawnRate: 35 },
            { waveNumber: 7, duration: 60, enemies: [{ type: 'gai_liu_zi', weight: 5 }, { type: 'clown', weight: 4 }, { type: 'da_ye', weight: 2 }, { type: 'tao_wa_big', weight: 2 }], spawnRate: 30 },
            { waveNumber: 8, duration: 999, enemies: [{ type: 'boss_kpi', weight: 1 }], spawnRate: 99999, isBossWave: true }
        ];

        const SHOP_ITEMS = [
            { id: 'keyboard_cleaner', title: 'ÈîÆÁõòÊ∏ÖÁêÜÊ≥•', description: 'Âü∫Á°Ä‰º§ÂÆ≥ +1„ÄÇÂâçÊúüÁ•ûÂô®„ÄÇ', rarity: 'common', category: 'upgrade', price: 30, icon: 'üßπ', effect: (state) => { state.player.attackDamage += 1; } },
            { id: 'mechanical_keyboard', title: 'Êú∫Ê¢∞ÈîÆÁõò', description: 'ÊîªÈÄü +15%ÔºåÊâìÂ≠óÂ¶ÇÈ£û„ÄÇ', rarity: 'common', category: 'upgrade', price: 50, icon: '‚å®Ô∏è', effect: (state) => { state.player.attackSpeed = Math.max(5, state.player.attackSpeed * 0.85); } },
            { id: 'big_lung', title: 'Â§ßÂóìÈó®', description: '‰º§ÂÆ≥ +20%ÔºåËæìÂá∫ÂÖ®Èù†Âêº„ÄÇ(Á¨¨3Ê≥¢ÂêéËß£ÈîÅ)', rarity: 'common', category: 'upgrade', minWave: 3, price: 80, icon: 'üó£Ô∏è', effect: (state) => { state.player.attackDamage *= 1.2; } },
            { id: 'thick_face', title: 'Èò≤ÂºπËÑ∏ÁöÆ', description: 'ÊúÄÂ§ßÁîüÂëΩ +30ÔºåËÑ∏ÁöÆÂéöÂêÉÂæóÂºÄ„ÄÇ', rarity: 'rare', category: 'upgrade', price: 80, icon: 'üõ°Ô∏è', effect: (state) => { state.player.maxHp += 30; } },
            { id: '5g_speed',